<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Datalabels Plugin for showing values on bars/doughnut -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- Google Fonts - Inter for modern typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§¨‡•â‡§°‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        body {
            background: linear-gradient(135deg, #ddeaff 0%, #a1c4fd 100%); /* ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§ó‡•ç‡§∞‡•á‡§°‡§ø‡§Ø‡§Ç‡§ü ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            min-height: 100vh; /* ‡§ï‡§ø‡§Æ‡§æ‡§® ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§â‡§Ç‡§ö‡•Ä */
            padding: 2rem 1rem; /* ‡§∏‡§∞‡•ç‡§µ ‡§¨‡§æ‡§ú‡•Ç‡§Ç‡§®‡•Ä ‡§™‡•Ö‡§°‡§ø‡§Ç‡§ó */
            font-family: 'Inter', sans-serif; /* ‡§á‡§Ç‡§ü‡§∞ ‡§´‡•â‡§®‡•ç‡§ü ‡§µ‡§æ‡§™‡§∞‡§£‡•á */
            color: #1e293b; /* ‡§ó‡§°‡§¶ ‡§®‡§ø‡§≥‡§æ-‡§∞‡§æ‡§ñ‡§æ‡§°‡•Ä ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó */
        }
        /* ‡§ó‡•ç‡§≤‡§æ‡§∏‡§Æ‡•ã‡§∞‡•ç‡§´‡§ø‡§ù‡§Æ ‡§á‡§´‡•á‡§ï‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ */
        .glass {
            background: rgba(255,255,255,0.85); /* ‡§Ö‡§∞‡•ç‡§ß-‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡§ï ‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ */
            backdrop-filter: saturate(180%) blur(10px); /* ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä‡§≤‡§æ ‡§¨‡•ç‡§≤‡§∞ ‡§Ü‡§£‡§ø ‡§∏‡•Ö‡§ö‡•Å‡§∞‡•á‡§∂‡§® */
            border-radius: 1.2rem; /* ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ */
            box-shadow: 0 12px 32px 0 #38bdf825; /* ‡§π‡§≤‡§ï‡•Ä ‡§®‡§ø‡§≥‡•Ä ‡§∏‡§æ‡§µ‡§≤‡•Ä */
            padding: 1.7rem 1rem 1.5rem 1rem; /* ‡§Ü‡§§‡•Ç‡§® ‡§™‡•Ö‡§°‡§ø‡§Ç‡§ó */
            margin: 0 auto; /* ‡§Æ‡§ß‡•ç‡§Ø‡§≠‡§æ‡§ó‡•Ä ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§ï‡§∞‡§æ */
        }
        /* KPI ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        .kpi-card {
            border-radius: 1.05em; /* ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ */
            padding: 1.3em .5em; /* ‡§Ü‡§§‡•Ç‡§® ‡§™‡•Ö‡§°‡§ø‡§Ç‡§ó */
            text-align: center; /* ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§Æ‡§ß‡•ç‡§Ø‡§≠‡§æ‡§ó‡•Ä */
            background: white; /* ‡§™‡§æ‡§Ç‡§¢‡§∞‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            box-shadow: 0 3px 14px #94a3b866; /* ‡§π‡§≤‡§ï‡•Ä ‡§∞‡§æ‡§ñ‡§æ‡§°‡•Ä ‡§∏‡§æ‡§µ‡§≤‡•Ä */
            font-weight: 700; /* ‡§†‡§≥‡§ï ‡§´‡•â‡§®‡•ç‡§ü */
            position: relative; /* ‡§ü‡•Ç‡§≤‡§ü‡§ø‡§™‡§∏‡§æ‡§†‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï */
            cursor: pointer; /* ‡§ï‡§∞‡•ç‡§∏‡§∞ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§¨‡§¶‡§≤‡§§‡•ã */
            transition: transform 0.20s, box-shadow 0.18s; /* ‡§π‡•ã‡§µ‡•ç‡§π‡§∞ ‡§á‡§´‡•á‡§ï‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§£ */
            border: 2px solid #93c5fd33; /* ‡§π‡§≤‡§ï‡•Ä ‡§®‡§ø‡§≥‡•Ä ‡§ï‡§ø‡§®‡§æ‡§∞ */
        }
        .kpi-card:hover {
            transform: scale(1.072); /* ‡§π‡•ã‡§µ‡•ç‡§π‡§∞ ‡§ï‡•á‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§•‡•ã‡§°‡•á ‡§Æ‡•ã‡§†‡•á ‡§π‡•ã‡§§‡•á */
            box-shadow: 0 12px 34px #2563eb33; /* ‡§ó‡§°‡§¶ ‡§®‡§ø‡§≥‡•Ä ‡§∏‡§æ‡§µ‡§≤‡•Ä */
            border: 2.25px solid #1e40af77; /* ‡§ó‡§°‡§¶ ‡§®‡§ø‡§≥‡•Ä ‡§ï‡§ø‡§®‡§æ‡§∞ */
            color: #1e40af; /* ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó ‡§¨‡§¶‡§≤‡§§‡•ã */
            z-index:2; /* ‡§á‡§§‡§∞ ‡§ò‡§ü‡§ï‡§æ‡§Ç‡§µ‡§∞ ‡§¶‡§ø‡§∏‡§§‡•á */
        }
        .kpi-label { font-size: 1.16em; margin-top: 0.19em; color: #475569; font-weight: 800;} /* KPI ‡§≤‡•á‡§¨‡§≤ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .kpi-value { font-size: 2.3em; color:#2563eb; font-weight:900; margin-bottom:0.1em;} /* KPI ‡§µ‡•ç‡§π‡•Ö‡§≤‡•ç‡§Ø‡•Ç ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        /* ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§™‡§ø‡§≤‡§∏‡§æ‡§†‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä ‡§∞‡§Ç‡§ó */
        .pill-top { background:#bbf7d0cc; color:#065f46;} /* ‡§π‡§ø‡§∞‡§µ‡§æ */
        .pill-mid { background:#feefb3bb; color:#78350f;} /* ‡§™‡§ø‡§µ‡§≥‡§æ */
        .pill-bottom { background:#fecacabb; color:#991b1b;} /* ‡§≤‡§æ‡§≤ */
        .kpi-info { font-size:1em; font-weight:600; line-height:1.5; } /* KPI ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        /* ‡§ü‡•Ç‡§≤‡§ü‡§ø‡§™‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .tooltip2:hover::after {
            content: attr(data-tooltip2); /* data-tooltip2 ‡•≤‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡§Æ‡§ß‡•Ä‡§≤ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§¶‡§æ‡§ñ‡§µ‡§§‡•á */
            position: absolute; /* ‡§ï‡§æ‡§∞‡•ç‡§°‡§ö‡•ç‡§Ø‡§æ ‡§∏‡§æ‡§™‡•á‡§ï‡•ç‡§∑ ‡§∏‡•ç‡§•‡§æ‡§® */
            left:50%;top:-2.1em;transform:translateX(-50%); /* ‡§Æ‡§ß‡•ç‡§Ø‡§≠‡§æ‡§ó‡•Ä ‡§Ü‡§£‡§ø ‡§µ‡§∞‡§§‡•Ä */
            background: #0ea5e9; color: #fff; /* ‡§®‡§ø‡§≥‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä, ‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ */
            font-size:0.97em; padding:0.23em 0.95em; /* ‡§´‡•â‡§®‡•ç‡§ü ‡§Ü‡§£‡§ø ‡§™‡•Ö‡§°‡§ø‡§Ç‡§ó */
            border-radius: .4em; pointer-events:none;opacity:0.97; /* ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ, ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§®‡§æ‡§π‡•Ä, ‡§Ö‡§∞‡•ç‡§ß-‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡§ï */
            box-shadow:0 2px 9px #2563eb1a;white-space:nowrap; /* ‡§∏‡§æ‡§µ‡§≥‡•Ä ‡§Ü‡§£‡§ø ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§è‡§ï‡§æ ‡§ì‡§≥‡•Ä‡§§ */
        }
        /* ‡§ü‡•á‡§¨‡§≤ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        table {border-radius:0.8em; font-size:0.97em; overflow: hidden;} /* ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ ‡§Ü‡§£‡§ø ‡§´‡•â‡§®‡•ç‡§ü */
        thead tr th { background: #2563eb; color: white; padding:10px 13px; font-weight:700;} /* ‡§π‡•á‡§°‡§∞ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        tbody tr { background: white; border-bottom: 1px solid #e7e5de;} /* ‡§¨‡•â‡§°‡•Ä ‡§∞‡•ã ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        tbody tr:hover { background:#e0e7ff95;} /* ‡§π‡•ã‡§µ‡•ç‡§π‡§∞ ‡§ï‡•á‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§∞‡§Ç‡§ó ‡§¨‡§¶‡§≤‡§§‡•ã */
        tbody tr.selected {background:#fef3c7;font-weight:900;color:#78350f;} /* ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        td {padding:10px 13px;text-align:center;} /* ‡§∏‡•á‡§≤ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        /* ‡§¨‡§ü‡§£ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤‡§ø‡§Ç‡§ó */
        .btn {
            background: #1e40af;
            color:white;
            font-weight:700;
            padding:0.5em 1.3em;
            border-radius:0.4em;
            transition: background .22s, box-shadow .22s, transform .1s;
            border: none;
            cursor: pointer;
        }
        .btn:hover {
            background: #2563eb;
            box-shadow: 0 6px 22px #38bdf84a;
            transform: translateY(-2px);
        }
        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px #38bdf84a;
        }
        /* ‡§§‡•Å‡§≤‡§®‡§æ ‡§¨‡§ü‡§£‡§æ‡§∏‡§æ‡§†‡•Ä ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        #cmpBtn {
            background: linear-gradient(45deg, #2563eb, #3b82f6); /* ‡§®‡§ø‡§≥‡§æ ‡§ó‡•ç‡§∞‡•á‡§°‡§ø‡§Ø‡§Ç‡§ü */
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }
        #cmpBtn:hover {
            background: linear-gradient(45deg, #3b82f6, #60a5fa); /* ‡§π‡•ã‡§µ‡•ç‡§π‡§∞‡§µ‡§∞ ‡§π‡§≤‡§ï‡§æ ‡§ó‡•ç‡§∞‡•á‡§°‡§ø‡§Ø‡§Ç‡§ü */
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.6);
        }

        /* ‡§®‡§µ‡•Ä‡§® ‡§ü‡•á‡§¨‡§≤ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•ã‡§≤‡§ø‡§Ç‡§ó‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .table-scroll-container {
            max-height: 400px; /* ‡§ü‡•á‡§¨‡§≤‡§ö‡•Ä ‡§ï‡§Æ‡§æ‡§≤ ‡§â‡§Ç‡§ö‡•Ä */
            overflow-y: auto; /* ‡§â‡§≠‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•ã‡§≤‡§ø‡§Ç‡§ó‡§∏‡§æ‡§†‡•Ä */
            border-radius: 0.8em; /* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡§∏‡§æ‡§†‡•Ä ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); /* ‡§π‡§≤‡§ï‡•Ä ‡§∏‡§æ‡§µ‡§≤‡•Ä */
            background-color: white; /* ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä ‡§∞‡§Ç‡§ó */
        }
        .table-scroll-container table {
            margin-top: 0; /* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§®‡•á ‡§Æ‡§æ‡§∞‡•ç‡§ú‡§ø‡§®‡§ö‡•Ä ‡§ó‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä */
            border-radius: 0; /* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡§≤‡§æ ‡§ï‡§°‡§æ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§®‡•á ‡§ü‡•á‡§¨‡§≤‡§≤‡§æ ‡§ó‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä */
            box-shadow: none; /* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡§≤‡§æ ‡§∏‡§æ‡§µ‡§≤‡•Ä ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§®‡•á ‡§ü‡•á‡§¨‡§≤‡§≤‡§æ ‡§ó‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä */
            border-collapse: separate; /* sticky headers/columns ‡§∏‡§æ‡§†‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï */
            border-spacing: 0; /* sticky headers/columns ‡§∏‡§æ‡§†‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï */
        }
        .table-scroll-container thead th {
            position: sticky; /* ‡§π‡•á‡§°‡§∞ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•ã‡§≤ ‡§ï‡§∞‡§§‡§æ‡§®‡§æ ‡§ö‡§ø‡§ï‡§ü‡•Ç‡§® ‡§∞‡§æ‡§π‡§§‡•Ä‡§≤ */
            top: 0;
            background: #2563eb; /* ‡§π‡•á‡§°‡§∞‡§ö‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            z-index: 10; /* ‡§á‡§§‡§∞ ‡§ò‡§ü‡§ï‡§æ‡§Ç‡§µ‡§∞ ‡§¶‡§ø‡§∏‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä */
        }
        /* ‡§™‡§π‡§ø‡§≤‡•ç‡§Ø‡§æ ‡§¶‡•ã‡§® ‡§ï‡•â‡§≤‡§Æ‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§ø‡§ï‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .table-scroll-container thead th.sticky-col-0,
        .table-scroll-container tbody td.sticky-col-0 {
            position: sticky;
            left: 0;
            z-index: 11; /* ‡§π‡•á‡§°‡§∞‡§™‡•á‡§ï‡•ç‡§∑‡§æ ‡§ú‡§æ‡§∏‡•ç‡§§ z-index */
            background-color: #2563eb; /* ‡§π‡•á‡§°‡§∞‡§∏‡§æ‡§†‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            color: white; /* ‡§π‡•á‡§°‡§∞‡§∏‡§æ‡§†‡•Ä ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó */
        }
        .table-scroll-container tbody td.sticky-col-0 {
            background-color: white; /* ‡§¨‡•â‡§°‡•Ä ‡§∏‡•á‡§≤‡§∏‡§æ‡§†‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            color: #1e293b; /* ‡§¨‡•â‡§°‡•Ä ‡§∏‡•á‡§≤‡§∏‡§æ‡§†‡•Ä ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó */
        }

        .table-scroll-container thead th.sticky-col-1,
        .table-scroll-container tbody td.sticky-col-1 {
            position: sticky;
            left: 60px; /* '‡§Ö.‡§ï‡•ç‡§∞.' ‡§ï‡•â‡§≤‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§∞‡•Å‡§Ç‡§¶‡•Ä‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∏‡§Æ‡§æ‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡§æ */
            z-index: 11; /* ‡§π‡•á‡§°‡§∞‡§™‡•á‡§ï‡•ç‡§∑‡§æ ‡§ú‡§æ‡§∏‡•ç‡§§ z-index */
            background-color: #2563eb; /* ‡§π‡•á‡§°‡§∞‡§∏‡§æ‡§†‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            color: white; /* ‡§π‡•á‡§°‡§∞‡§∏‡§æ‡§†‡•Ä ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó */
        }
        .table-scroll-container tbody td.sticky-col-1 {
            background-color: white; /* ‡§¨‡•â‡§°‡•Ä ‡§∏‡•á‡§≤‡§∏‡§æ‡§†‡•Ä ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä */
            color: #1e293b; /* ‡§¨‡•â‡§°‡•Ä ‡§∏‡•á‡§≤‡§∏‡§æ‡§†‡•Ä ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§∞‡§Ç‡§ó */
        }
        /* ‡§π‡•â‡§∞‡§ø‡§ù‡•â‡§®‡•ç‡§ü‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§≤‡•á‡§¨‡§≤‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        #horizontalBarChart canvas {
            max-height: 384px; /* h-96 */
        }
    </style>
</head>
<body>
<div class="glass max-w-7xl">
    <h1 class="text-3xl md:text-4xl font-extrabold mb-1 text-center text-sky-800 drop-shadow">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h1>
    <p class="mb-6 mt-1 text-center text-sky-900 opacity-90">(‡§ï‡§Æ‡•Ä ‡§∞‡§Å‡§ï = ‡§â‡§§‡•ç‡§§‡§Æ ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä)</p>
    <div class="flex flex-col md:flex-row gap-4 items-center justify-center mb-6">
        <!-- ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§°‡•ç‡§∞‡•â‡§™down -->
        <select id="talukaSelect" class="rounded border-gray-400 border p-2 w-[260px]" disabled>
            <option value="">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>
        </select>
        <!-- ‡§®‡§µ‡•Ä‡§® ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§°‡•ç‡§∞‡•â‡§™down -->
        <select id="schemeSelect" class="rounded border-gray-400 border p-2 w-[260px]" disabled>
            <option value="">‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>
        </select>
        <!-- ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§¨‡§ü‡§£ -->
        <button id="resetBtn" class="btn" style="display:none;">‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§§‡§æ‡§≤‡•Å‡§ï‡•á ‡§™‡§æ‡§π‡§æ</button>
    </div>
    <!-- ‡§Æ‡•Å‡§ñ‡•ç‡§Ø KPI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§¨‡•ç‡§≤‡•â‡§ï‡•ç‡§∏ -->
    <div id="kpiSummary" class="grid grid-cols-2 md:grid-cols-4 gap-5 mb-7"></div>
    <!-- ‡§ü‡•â‡§™/‡§Æ‡§ß‡•ç‡§Ø‡§Æ/‡§§‡§≥‡§ü‡•Ä‡§™ ‡•© ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ KPI ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏ -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-9">
        <div class="kpi-card pill-top tooltip2" data-tooltip2="‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§† ‡•© ‡§§‡§æ‡§≤‡•Å‡§ï‡•á">
            <div class="kpi-value" style="color:#16a34a;">ü•á</div>
            <div class="kpi-label">Top 3</div>
            <ul id="top3List" class="mt-1 text-green-900 font-semibold"></ul>
        </div>
        <div class="kpi-card pill-mid tooltip2" data-tooltip2="‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡•© ‡§§‡§æ‡§≤‡•Å‡§ï‡•á">
            <div class="kpi-value" style="color:#b45309;">‚öñÔ∏è</div>
            <div class="kpi-label">‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡•©</div>
            <ul id="mid3List" class="mt-1 text-amber-800 font-semibold"></ul>
        </div>
        <div class="kpi-card pill-bottom tooltip2" data-tooltip2="‡§§‡§≥‡§ü‡•Ä‡§™ ‡•© ‡§§‡§æ‡§≤‡•Å‡§ï‡•á">
            <div class="kpi-value" style="color:#dc2626;">ü•â</div>
            <div class="kpi-label">‡§§‡§≥‡§ü‡•Ä‡§™ ‡•©</div>
            <ul id="bottom3List" class="mt-1 text-red-800 font-semibold"></ul>
        </div>
    </div>
    <!-- ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏ ‡§µ‡§ø‡§≠‡§æ‡§ó -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-7 mb-10">
        <div class="bg-white rounded-lg p-5 shadow-lg h-80"> <!-- h-80 ‡§ú‡•ã‡§°‡§≤‡•á ‡§Ü‡§π‡•á -->
            <h3 class="font-semibold mb-3 text-center text-sky-800">‡§∏‡§∞‡•ç‡§µ ‡§Ø‡•ã‡§ú‡§®‡§æ - ‡§∏‡§∞‡§æ‡§∏‡§∞‡•Ä ‡§∏‡•ç‡§•‡§æ‡§® (Vertical Bar)</h3>
            <canvas id="barChart"></canvas> <!-- height ‡•≤‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ‡§¢‡§≤‡•á ‡§Ü‡§π‡•á -->
        </div>
        <div class="bg-white rounded-lg p-5 shadow-lg h-80"> <!-- h-80 ‡§ú‡•ã‡§°‡§≤‡•á ‡§Ü‡§π‡•á -->
            <h3 class="font-semibold mb-3 text-center text-sky-800">‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•á ‡§µ‡§∞‡•ç‡§ó‡•Ä‡§ï‡§∞‡§£ (Donut)</h3>
            <canvas id="donutChart"></canvas> <!-- height ‡•≤‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ‡§¢‡§≤‡•á ‡§Ü‡§π‡•á -->
        </div>
    </div>
    <!-- ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§: ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§π‡§æ‡§Ø ‡§ï‡•ç‡§∑‡•à‡§§‡§ø‡§ú ‡§¨‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü -->
    <div class="mb-12 bg-white p-5 rounded-lg shadow-lg h-96"> <!-- h-96 ‡§ú‡•ã‡§°‡§≤‡•á ‡§Ü‡§π‡•á -->
        <h3 class="font-semibold mb-4 text-sky-900">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞ (Horizontal Bar)</h3>
        <!-- ‡§®‡§µ‡•Ä‡§® ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§°‡•ç‡§∞‡•â‡§™‡§°‡§æ‡§â‡§® (Horizontal Bar Chart ‡§∏‡§æ‡§†‡•Ä) -->
        <select id="schemeSelectForHorizontalChart" class="rounded border-gray-400 border p-2 w-[260px] mb-4" disabled>
            <option value="">‡§∏‡§∞‡•ç‡§µ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏</option>
        </select>
        <canvas id="horizontalBarChart"></canvas> <!-- height ‡•≤‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ‡§¢‡§≤‡•á ‡§Ü‡§π‡•á -->
    </div>
    <!-- ‡§ü‡•á‡§¨‡§≤: ‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞-‡§®‡§ø‡§π‡§æ‡§Ø ‡§ü‡•â‡§™ (‡§ü‡§æ‡§Ø) ‡§§‡§æ‡§≤‡•Å‡§ï‡•á -->
    <div class="mb-6 bg-white p-4 rounded-lg shadow">
        <h3 class="font-semibold text-sky-900 mb-3">‡§Ø‡•ã‡§ú‡§®‡§æ‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ü‡•â‡§™ ‡§∞‡§Å‡§ï ‡§µ ‡§ü‡§æ‡§Ø ‡§§‡§æ‡§≤‡•Å‡§ï‡•á</h3>
        <table id="paramTopTable" class="min-w-full"></table>
    </div>
    <!-- ‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§Ø‡§æ‡§¶‡•Ä ‡§ü‡•á‡§¨‡§≤ -->
    <div class="overflow-x-auto mb-10 bg-white rounded-lg p-4 shadow table-scroll-container">
        <h3 class="font-semibold text-sky-900 mb-2">‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§Ø‡§æ‡§¶‡•Ä</h3>
        <table id="fullTable" class="min-w-full"></table>
    </div>
    <!-- ‡§§‡•Å‡§≤‡§®‡§æ ‡§µ‡§ø‡§≠‡§æ‡§ó -->
    <div class="bg-white rounded-lg p-5 shadow-md">
        <h3 class="font-semibold text-center mb-4">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§§‡•Å‡§≤‡§®‡§æ ‡§ï‡§∞‡§æ</h3>
        <div class="flex flex-col md:flex-row items-center gap-3 mb-3">
            <select id="cmpA" class="border rounded p-2 w-[180px]"></select>
            <span>-VS-</span>
            <select id="cmpB" class="border rounded p-2 w-[180px]"></select>
            <button id="cmpBtn" class="btn">‡§§‡•Å‡§≤‡§®‡§æ</button>
        </div>
        <div id="cmpResult"></div>
    </div>
</div>
<script>
// Chart.js datalabels ‡§™‡•ç‡§≤‡§ó‡§á‡§® ‡§ú‡§æ‡§ó‡§§‡§ø‡§ï ‡§∏‡•ç‡§§‡§∞‡§æ‡§µ‡§∞ ‡§®‡•ã‡§Ç‡§¶‡§£‡•Ä ‡§ï‡§∞‡§æ
Chart.register(ChartDataLabels);

// Google Sheet ID, ‡§∞‡•á‡§Ç‡§ú ‡§Ü‡§£‡§ø API ‡§ï‡•Ä ‡§ï‡•â‡§®‡•ç‡§∏‡•ç‡§ü‡§Ç‡§ü‡•ç‡§∏
const SHEET_ID = "1aINSij-6mXtt4Gbocn0A1PHbuh7XMImHL0zFmdVKhVs";
const RANGE = "Rank!B5:AI20"; // ‡§µ‡§æ‡§™‡§∞‡§ï‡§∞‡•ç‡§§‡•ç‡§Ø‡§æ‡§®‡•á ‡§¶‡§ø‡§≤‡•á‡§≤‡•Ä ‡§∞‡•á‡§Ç‡§ú
const API_KEY = "AIzaSyCD236Hc9OAwXldM_IBzwFT-4ZCiIIPP2M";

// ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•ç‡§π‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏
let headers = [], data = [], talukas = [], schemes = [];
let barChartInstance = null; // ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§µ‡•ç‡§π‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏‡§≤‡§æ null ‡§®‡•á ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ù ‡§ï‡§∞‡§æ
let donutChartInstance = null;
let horizontalBarChartInstance = null;

// ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§‡§™‡§£‡•á ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó‡§≤‡§æ ‡§®‡§Ç‡§¨‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§æ. ‡§Ö‡§µ‡•à‡§ß ‡§®‡§Ç‡§¨‡§∞ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§∏ Infinity ‡§™‡§∞‡§§ ‡§ï‡§∞‡§æ (‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§µ‡§æ‡§à‡§ü ‡§∞‡§Å‡§ï‡§∏‡§æ‡§†‡•Ä).
function safeNum(x) {
    let n = +x; // ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó‡§≤‡§æ ‡§®‡§Ç‡§¨‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ
    return isNaN(n) ? Infinity : n; // ‡§ú‡§∞ NaN ‡§Ö‡§∏‡•á‡§≤ ‡§§‡§∞ Infinity, ‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ ‡§®‡§Ç‡§¨‡§∞
}

// ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ù ‡§ï‡§∞‡§æ ‡§Ü‡§£‡§ø ‡§°‡•á‡§ü‡§æ ‡§´‡•á‡§ö ‡§ï‡§∞‡§æ
async function init() {
    // Google Sheets API URL ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ
    let url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
    
    // UI ‡§ò‡§ü‡§ï‡§æ‡§Ç‡§®‡§æ ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§•‡§ø‡§§‡•Ä ‡§¶‡§∞‡•ç‡§∂‡§µ‡§æ
    document.getElementById('talukaSelect').innerHTML = `<option value="">‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</option>`;
    document.getElementById('talukaSelect').disabled = true;
    document.getElementById('schemeSelect').innerHTML = `<option value="">‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</option>`;
    document.getElementById('schemeSelect').disabled = true;
    document.getElementById('schemeSelectForHorizontalChart').innerHTML = `<option value="">‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</option>`;
    document.getElementById('schemeSelectForHorizontalChart').disabled = true;
    document.getElementById('resetBtn').style.display = 'none';
    document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-gray-500">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</div>`;
    document.getElementById('top3List').innerHTML = `<li>‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</li>`;
    document.getElementById('mid3List').innerHTML = `<li>‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</li>`;
    document.getElementById('bottom3List').innerHTML = `<li>‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</li>`;
    document.getElementById('paramTopTable').innerHTML = `<thead><tr><th>‡§Ø‡•ã‡§ú‡§®‡§æ</th><th>üëë Top</th><th>‚öñÔ∏è Middle</th><th>ü•â Down</th></tr></thead><tbody><tr><td colspan="4" class="text-center text-gray-500">‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</td></tr></tbody>`;
    document.getElementById('fullTable').innerHTML = `<thead><tr><th>‡§Ö.‡§ï‡•ç‡§∞.</th><th>‡§§‡§æ‡§≤‡•Å‡§ï‡§æ</th></tr></thead><tbody><tr><td colspan="2" class="text-center text-gray-500">‡§≤‡•ã‡§° ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...</td></tr></tbody>`;

    try {
        // API ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§æ
        let r = await fetch(url);
        // ‡§ú‡§∞ ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡§æ‡§¶ ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä ‡§®‡§∏‡•á‡§≤ (‡§â‡§¶‡§æ. 404, 403), ‡§§‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§´‡•á‡§ï‡§æ
        if (!r.ok) {
            const errorText = await r.text();
            console.error('API ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡§æ‡§¶ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä:', r.status, r.statusText, errorText);
            throw new Error(`‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≥‡§µ‡§§‡§æ‡§®‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§Ü‡§≤‡•Ä: ${r.statusText}. ‡§ï‡•É‡§™‡§Ø‡§æ Sheet ID, Range ‡§Ü‡§£‡§ø API Key ‡§§‡§™‡§æ‡§∏‡§æ.`);
        }
        // ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡§æ‡§¶‡§æ‡§≤‡§æ JSON ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§æ
        let j = await r.json();

        // ‡§°‡•Ä‡§¨‡§ó‡§ø‡§Ç‡§ó‡§∏‡§æ‡§†‡•Ä ‡§ï‡§®‡•ç‡§∏‡•ã‡§≤‡§Æ‡§ß‡•ç‡§Ø‡•á API ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡§æ‡§¶ ‡§≤‡•â‡§ó ‡§ï‡§∞‡§æ
        console.log('API Response data.values:', j.values); 
        console.log('First row (potential headers):', j.values ? j.values[0] : 'No values array'); 

        // ‡§ú‡§∞ ‡§°‡•á‡§ü‡§æ ‡§µ‡•ç‡§π‡•Ö‡§≤‡•ç‡§Ø‡•Ç‡§ú ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•ç‡§Ø‡§æ ‡§Ö‡§∏‡§§‡•Ä‡§≤ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§∏‡§§‡•Ä‡§≤, ‡§§‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡§æ‡§ñ‡§µ‡§æ
        if (!j.values || j.values.length === 0) {
            document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-red-600 font-semibold">Google Sheet ‡§Æ‡§ß‡•Ç‡§® ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§Ü‡§¢‡§≥‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä. ‡§ï‡•É‡§™‡§Ø‡§æ Sheet ID, Range ‡§Ü‡§£‡§ø Sheet ‡§Æ‡§ß‡•Ä‡§≤ ‡§°‡•á‡§ü‡§æ ‡§§‡§™‡§æ‡§∏‡§æ.</div>`;
            return;
        }

        // ‡§™‡§π‡§ø‡§≤‡•Ä ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä ‡§π‡•á‡§°‡§∞ ‡§Æ‡•ç‡§π‡§£‡•Ç‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ
        headers = j.values[0];
        // ‡§ú‡§∞ ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•á ‡§Ö‡§∏‡§§‡•Ä‡§≤, ‡§§‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡§æ‡§ñ‡§µ‡§æ
        if (!headers || headers.length === 0) {
            document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-red-600 font-semibold">Google Sheet ‡§Æ‡§ß‡•Ç‡§® ‡§π‡•á‡§°‡§∞‡•ç‡§∏ (Headers) ‡§Ü‡§¢‡§≥‡§≤‡•á ‡§®‡§æ‡§π‡•Ä‡§§. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ñ‡§æ‡§§‡•ç‡§∞‡•Ä ‡§ï‡§∞‡§æ ‡§ï‡•Ä ‡§∞‡•á‡§Ç‡§ú‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§™‡§π‡§ø‡§≤‡•Ä ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§Ü‡§π‡•á‡§§.</div>`;
            return;
        }

        // ‡§°‡•á‡§ü‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä‡§Ç‡§®‡§æ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§æ ‡§Ü‡§£‡§ø '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' ‡§®‡§∏‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§æ
        data = j.values.slice(1).map(row => {
            const rowObject = {};
            headers.forEach((h, i) => {
                rowObject[h] = row[i] || ""; // ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•ç‡§Ø‡§æ ‡§∏‡•á‡§≤‡§∏‡§æ‡§†‡•Ä ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•Ä ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó
            });
            return rowObject;
        }).filter(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'] && r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'].trim() !== ''); // ‡§´‡§ï‡•ç‡§§ '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' ‡§®‡§æ‡§µ ‡§Ö‡§∏‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§æ

        // ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§Ø‡§æ‡§¶‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ
        talukas = data.map(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ']);
        // ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏‡§ö‡•Ä ‡§Ø‡§æ‡§¶‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ (‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§Ü‡§£‡§ø ‡§Ö.‡§ï‡•ç‡§∞. ‡§µ‡§ó‡§≥‡•Ç‡§®)
        schemes = headers.filter(h => h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' && h !== '‡§Ö.‡§ï‡•ç‡§∞.');


        // ‡§°‡•Ä‡§¨‡§ó‡§ø‡§Ç‡§ó‡§∏‡§æ‡§†‡•Ä ‡§ï‡§®‡•ç‡§∏‡•ã‡§≤‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á‡§≤‡•á‡§≤‡§æ ‡§°‡•á‡§ü‡§æ ‡§≤‡•â‡§ó ‡§ï‡§∞‡§æ
        console.log('Processed Headers:', headers);
        console.log('Processed Data:', data);
        console.log('Talukas:', talukas);
        console.log('Schemes:', schemes);


        // ‡§ú‡§∞ ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ 0 ‡§Ö‡§∏‡•á‡§≤, ‡§§‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡§æ‡§ñ‡§µ‡§æ
        if (talukas.length === 0) {
            document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-red-600 font-semibold">‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§∂‡•Ä‡§ü‡§Æ‡§ß‡•Ä‡§≤ "‡§§‡§æ‡§≤‡•Å‡§ï‡§æ" ‡§ï‡•â‡§≤‡§Æ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§®‡§æ‡§µ‡•á ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§ñ‡§æ‡§§‡•ç‡§∞‡•Ä ‡§ï‡§∞‡§æ.</div>`;
            return;
        }

        // UI ‡§ò‡§ü‡§ï ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§æ ‡§Ü‡§£‡§ø ‡§°‡•á‡§ü‡§æ ‡§™‡•â‡§™‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü ‡§ï‡§∞‡§æ
        document.getElementById('talukaSelect').disabled = false;
        document.getElementById('talukaSelect').innerHTML =
            `<option value="">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>` + talukas.map(t => `<option>${t}</option>`).join('');

        document.getElementById('schemeSelect').disabled = false;
        document.getElementById('schemeSelect').innerHTML =
            `<option value="">‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§æ</option>` + schemes.map(s => `<option>${s}</option>`).join('');
        
        document.getElementById('schemeSelectForHorizontalChart').disabled = false;
        document.getElementById('schemeSelectForHorizontalChart').innerHTML =
            `<option value="">‡§∏‡§∞‡•ç‡§µ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏</option>` + schemes.map(s => `<option>${s}</option>`).join('');


        // ‡§∏‡§∞‡•ç‡§µ ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§ò‡§ü‡§ï ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
        filterDataAndRender(); // ‡§®‡§µ‡•Ä‡§® ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞‡§ø‡§Ç‡§ó ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§æ

    } catch (error) {
        // ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§Ü‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§®‡•ç‡§∏‡•ã‡§≤‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§≤‡•â‡§ó ‡§ï‡§∞‡§æ ‡§Ü‡§£‡§ø UI ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡§æ‡§ñ‡§µ‡§æ
        console.error('‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≥‡§µ‡§§‡§æ‡§®‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä ‡§Ü‡§≤‡•Ä:', error);
        document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-red-600 font-semibold">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§§‡§æ‡§®‡§æ ‡§§‡•ç‡§∞‡•Å‡§ü‡•Ä: ${error.message}. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡§®‡•ç‡§∏‡•ã‡§≤ ‡§§‡§™‡§æ‡§∏‡§æ.</div>`;
    }
}

// ‡§°‡•á‡§ü‡§æ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§æ ‡§Ü‡§£‡§ø ‡§°‡•Ö‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
function filterDataAndRender() {
    const selectedTaluka = document.getElementById('talukaSelect').value;
    const selectedScheme = document.getElementById('schemeSelect').value;
    const selectedSchemeForHorizontalChart = document.getElementById('schemeSelectForHorizontalChart').value;

    let filteredData = data;
    let filteredSchemes = schemes;
    let filteredSchemesForHorizontalChart = schemes;

    if (selectedTaluka) {
        filteredData = data.filter(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'] === selectedTaluka);
    }

    if (selectedScheme) {
        filteredSchemes = [selectedScheme];
    } else {
        filteredSchemes = headers.filter(h => h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' && h !== '‡§Ö.‡§ï‡•ç‡§∞.');
    }

    if (selectedSchemeForHorizontalChart) {
        filteredSchemesForHorizontalChart = [selectedSchemeForHorizontalChart];
    } else {
        filteredSchemesForHorizontalChart = headers.filter(h => h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' && h !== '‡§Ö.‡§ï‡•ç‡§∞.');
    }


    renderSummaryKPI(selectedTaluka, filteredData, filteredSchemes);
    renderTopMidBot(filteredData, filteredSchemes);
    renderCharts(filteredData, filteredSchemes);
    renderHorizontalChart(filteredData, filteredSchemesForHorizontalChart); // ‡§π‡•â‡§∞‡§ø‡§ù‡•â‡§®‡•ç‡§ü‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§µ‡•á‡§ó‡§≥‡•Ä ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞‡§ø‡§Ç‡§ó
    renderParamTops(filteredData, filteredSchemes);
    renderFullTable(filteredData, selectedTaluka, selectedScheme);
    populateCmpDropdowns();

    if (selectedTaluka || selectedScheme || selectedSchemeForHorizontalChart) {
        document.getElementById('resetBtn').style.display = 'inline-block';
    } else {
        document.getElementById('resetBtn').style.display = 'none';
    }
    highlightTableRow(selectedTaluka);
}


// ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ KPI (Key Performance Indicators) ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
function renderSummaryKPI(selTaluka, currentData, currentSchemes) {
    const params = currentSchemes; // ‡§Ü‡§§‡§æ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏ ‡§µ‡§æ‡§™‡§∞‡§≤‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§§‡•Ä‡§≤
    let totalT = data.length; // ‡§è‡§ï‡•Ç‡§£ ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§®‡•á‡§π‡§Æ‡•Ä ‡§Æ‡•Ç‡§≥ ‡§°‡•á‡§ü‡§æ‡§µ‡§∞‡•Ç‡§®
    let totalP = schemes.length; // ‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏‡§ö‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§®‡•á‡§π‡§Æ‡•Ä ‡§Æ‡•Ç‡§≥ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏‡§µ‡§∞‡•Ç‡§®

    if (!selTaluka) { // ‡§ú‡§∞ ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡§æ ‡§®‡§∏‡•á‡§≤ (‡§°‡§ø‡§´‡•â‡§≤‡•ç‡§ü ‡§µ‡•ç‡§π‡•ç‡§Ø‡•Ç)
        document.getElementById('kpiSummary').innerHTML = `
            <div class="kpi-card tooltip2" data-tooltip2="‡§§‡§æ‡§≤‡•Å‡§ï‡•á (${totalT})"><div class="kpi-value">${totalT}</div><div class="kpi-label">‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§è‡§ï‡•Ç‡§£ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</div></div>
            <div class="kpi-card tooltip2" data-tooltip2="‡§Ø‡•ã‡§ú‡§®‡§æ/‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ç‡§∏ (${totalP})"><div class="kpi-value">${totalP}</div><div class="kpi-label">‡§Ø‡•ã‡§ú‡§®‡§æ/‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ç‡§∏</div></div>
            <div class="kpi-card tooltip2" data-tooltip2="Dashboard ‡§µ‡§æ‡§™‡§∞‡§æ!"><div class="kpi-value">üìä</div><div class="kpi-label">‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§ö‡§ø‡§§‡•ç‡§∞</div></div>
            <div class="kpi-card tooltip2" data-tooltip2="‡§ü‡•â‡§™ 5 ‡§Æ‡§ß‡•Ä‡§≤ ‡§Ø‡•ã‡§ú‡§®‡§æ/‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ç‡§∏ (‡§Ö‡§Ç‡§¶‡§æ‡§ú‡•á)"><div class="kpi-value">${Math.max(1, Math.floor(totalP * 0.7))}</div><div class="kpi-label">Bests: ‡§Ø‡•ã‡§ú‡§®‡§æ</div></div>
        `;
    } else { // ‡§ú‡§∞ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡§æ ‡§Ö‡§∏‡•á‡§≤
        let talD = data.find(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'] === selTaluka); // ‡§Æ‡•Ç‡§≥ ‡§°‡•á‡§ü‡§æ‡§µ‡§∞‡•Ç‡§® ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§∂‡•ã‡§ß‡§æ
        if (!talD) { 
            document.getElementById('kpiSummary').innerHTML = `<div class="col-span-4 text-center text-red-600 font-semibold">‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§°‡•á‡§ü‡§æ ‡§Ü‡§¢‡§≥‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä.</div>`;
            return;
        }

        let bestP = params[0], worstP = params[0]; 
        // ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§∏‡§∞‡•ç‡§µ‡•ã‡§§‡•ç‡§§‡§Æ/‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§µ‡§æ‡§à‡§ü ‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§∂‡•ã‡§ß‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§µ‡•à‡§ß ‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§∂‡•ã‡§ß‡§æ
        for(let p of params) {
            if (safeNum(talD[p]) !== Infinity) {
                bestP = p;
                worstP = p;
                break;
            }
        }

        let bestCnt = 0; 
        params.forEach(p => {
            const val = safeNum(talD[p]);
            if (val < safeNum(talD[bestP])) bestP = p; 
            if (val > safeNum(talD[worstP])) worstP = p; 
            if (val <= 5 && val !== Infinity) bestCnt++; 
        });

        // ‡§è‡§ï‡•Ç‡§£ ‡§∞‡§Å‡§ï‡§ö‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Æ‡•Ç‡§≥ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏ ‡§µ‡§æ‡§™‡§∞‡§≤‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§§‡•Ä‡§≤
        let allSchemesForRankSum = headers.filter(h => h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' && h !== '‡§Ö.‡§ï‡•ç‡§∞.');
        let rankSum = allSchemesForRankSum.reduce((a, p) => a + safeNum(talD[p]), 0);
        let allTalRankSum = data.map(r => allSchemesForRankSum.reduce((a, p) => a + safeNum(r[p]), 0));
        let overallRank = allTalRankSum.slice().sort((a, b) => a - b).findIndex(x => x === rankSum) + 1;

        document.getElementById('kpiSummary').innerHTML = `
            <div class="kpi-card pill-top tooltip2" data-tooltip2="‡§§‡•Å‡§Æ‡§ö‡§æ ‡§è‡§ï‡•Ç‡§£ ‡§∞‡§Å‡§ï">
                <div class="kpi-value" style="font-size: 1.8em;">${overallRank} / ${totalT}</div>
                <div class="kpi-label" style="font-size: 0.95em;">ü•á ‡§è‡§ï‡•Ç‡§£ ‡§∞‡§Å‡§ï</div>
            </div>
            <div class="kpi-card pill-mid tooltip2" data-tooltip2="Best PERFORMING Parameter">
                <div class="kpi-value" style="font-size: 1.8em;">${bestP}</div>
                <div class="kpi-label" style="font-size: 0.95em;">üìà ‡§∏‡§∞‡•ç‡§µ‡•ã‡§§‡•ç‡§§‡§Æ ‡§Ø‡•ã‡§ú‡§®‡§æ</div>
            </div>
            <div class="kpi-card pill-bottom tooltip2" data-tooltip2="Improvement Area">
                <div class="kpi-value" style="font-size: 1.8em;">${worstP}</div>
                <div class="kpi-label" style="font-size: 0.95em;">‚ö†Ô∏è ‡§∏‡•Å‡§ß‡§æ‡§∞‡§£‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï</div>
            </div>
            <div class="kpi-card tooltip2" data-tooltip2="‡§ü‡•â‡§™ 5 ‡§Æ‡§ß‡•Ä‡§≤ ‡§Ø‡•ã‡§ú‡§®‡§æ/‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ç‡§∏">
                <div class="kpi-value" style="font-size: 1.8em;">${bestCnt} / ${params.length}</div>
                <div class="kpi-label" style="font-size: 0.95em;">üèÖ ‡§ü‡•â‡§™ ‡§Ø‡•ã‡§ú‡§®‡§æ</div>
            </div>
        `;
    }
}

// ‡§ü‡•â‡§™, ‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§Ü‡§£‡§ø ‡§§‡§≥‡§ü‡•Ä‡§™ ‡•© ‡§§‡§æ‡§≤‡•Å‡§ï‡•á ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
function renderTopMidBot(currentData, currentSchemes) {
    const params = currentSchemes;
    if (currentData.length === 0 || params.length === 0) {
        document.getElementById('top3List').innerHTML = `<li>‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä</li>`;
        document.getElementById('mid3List').innerHTML = `<li>‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä</li>`;
        document.getElementById('bottom3List').innerHTML = `<li>‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä</li>`;
        return;
    }

    let sumR = currentData.map(r => ({ t: r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'], s: params.reduce((a, p) => a + safeNum(r[p]), 0) }));
    let sorted = sumR.slice().sort((a, b) => a.s - b.s);
    let N = sorted.length;

    let top3 = sorted.slice(0, Math.min(3, N));
    let mid3 = [];
    if (N > 6) {
        let midStart = Math.floor(N / 2) - 1;
        mid3 = sorted.slice(Math.max(0, midStart), Math.min(N, midStart + 3));
    } else if (N > 3) {
        mid3 = sorted.slice(Math.min(3, N - 3), Math.max(3, N - 3) + 3);
    }
    let bot3 = sorted.slice(Math.max(0, N - 3), N);

    let ul = (lst, cls) => lst.map(a => `<li class="${cls}">${a.t}</li>`).join(''); 
    document.getElementById('top3List').innerHTML = ul(top3, "");
    document.getElementById('mid3List').innerHTML = ul(mid3, "");
    document.getElementById('bottom3List').innerHTML = ul(bot3, "");
}

// ‡§ö‡§æ‡§∞‡•ç‡§ü‡•ç‡§∏ ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ (‡§µ‡•ç‡§π‡§∞‡•ç‡§ü‡§ø‡§ï‡§≤ ‡§¨‡§æ‡§∞ ‡§Ü‡§£‡§ø ‡§°‡•ã‡§®‡§ü ‡§ö‡§æ‡§∞‡•ç‡§ü)
function renderCharts(currentData, currentSchemes) {
    const params = currentSchemes;
    if (currentData.length === 0 || params.length === 0) {
        if (barChartInstance) { barChartInstance.destroy(); barChartInstance = null; }
        if (donutChartInstance) { donutChartInstance.destroy(); donutChartInstance = null; }
        document.getElementById('barChart').innerHTML = `<p class="text-center text-gray-500 mt-4">‡§ö‡§æ‡§∞‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä.</p>`;
        document.getElementById('donutChart').innerHTML = `<p class="text-center text-gray-500 mt-4">‡§ö‡§æ‡§∞‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä.</p>`;
        return;
    }

    // ‡§µ‡•ç‡§π‡§∞‡•ç‡§ü‡§ø‡§ï‡§≤ ‡§¨‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü: ‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§µ‡§ø‡§∞‡•Å‡§¶‡•ç‡§ß ‡§∏‡§∞‡§æ‡§∏‡§∞‡•Ä ‡§∞‡§Å‡§ï
    let avgs = params.map(p => {
        let vals = currentData.map(r => safeNum(r[p])).filter(x => x !== Infinity);
        return vals.length > 0 ? vals.reduce((a, b) => a + b, 0) / vals.length : 0;
    });
    let ctx = document.getElementById('barChart').getContext('2d');
    if (barChartInstance) barChartInstance.destroy(); // ‡§ú‡•Å‡§®‡§æ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§æ‡§§ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§®‡§∑‡•ç‡§ü ‡§ï‡§∞‡§æ
    barChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: params,
            datasets: [{
                label: '‡§∏‡§∞‡§æ‡§∏‡§∞‡•Ä ‡§∞‡§Å‡§ï',
                data: avgs,
                backgroundColor: avgs.map(r => r < 5 ? '#22c55e' : r < 10 ? '#fbbf24' : '#ef4444'), // ‡§∞‡§Å‡§ï‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∞‡§Ç‡§ó
                borderRadius: 5 // ‡§¨‡§æ‡§∞‡§∏‡§æ‡§†‡•Ä ‡§ó‡•ã‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡§°‡§æ
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    reverse: true,
                    title: { display: true, text: '‡§∏‡§∞‡§æ‡§∏‡§∞‡•Ä ‡§∞‡§Å‡§ï', font: { size: 14, weight: 'bold' } }
                },
                x: {
                    title: { display: true, text: '‡§Ø‡•ã‡§ú‡§®‡§æ', font: { size: 14, weight: 'bold' } }
                }
            },
            plugins: {
                legend: { display: false }, // ‡§≤‡•á‡§ú‡•á‡§Ç‡§° ‡§≤‡§™‡§µ‡§æ
                datalabels: { // ‡§°‡•á‡§ü‡§æ ‡§≤‡•á‡§¨‡§≤ ‡§™‡•ç‡§≤‡§ó‡§á‡§®
                    anchor: 'end',
                    align: 'top',
                    formatter: (value) => value.toFixed(1), // ‡§µ‡•ç‡§π‡•Ö‡§≤‡•ç‡§Ø‡•Ç 1 ‡§¶‡§∂‡§æ‡§Ç‡§∂ ‡§∏‡•ç‡§•‡§≥‡§æ‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§ ‡§¶‡§æ‡§ñ‡§µ‡§æ
                    font: { weight: 'bold', size: 10 }
                },
                tooltip: { // ‡§ü‡•Ç‡§≤‡§ü‡§ø‡§™ ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§æ‡§Ø‡§ù‡•á‡§∂‡§®
                    callbacks: {
                        label: function(context) {
                            return `‡§∏‡§∞‡§æ‡§∏‡§∞‡•Ä ‡§∞‡§Å‡§ï: ${context.raw.toFixed(1)}`;
                        }
                    }
                }
            }
        }
    });

    // ‡§°‡•ã‡§®‡§ü ‡§ö‡§æ‡§∞‡•ç‡§ü (‡§ü‡•â‡§™/‡§Æ‡§ß‡•ç‡§Ø‡§Æ/‡§§‡§≥‡§ü‡•Ä‡§™)
    let sumR = currentData.map(r => ({ t: r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'], s: params.reduce((a, p) => a + safeNum(r[p]), 0) })).sort((a, b) => a.s - b.s);
    let N = sumR.length;
    let topQ = Math.floor(N * 0.33);
    let botQ = Math.floor(N * 0.33);
    let midQ = N - topQ - botQ;

    let dtx = document.getElementById('donutChart').getContext('2d');
    if (donutChartInstance) donutChartInstance.destroy(); // ‡§ú‡•Å‡§®‡§æ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§æ‡§§ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§®‡§∑‡•ç‡§ü ‡§ï‡§∞‡§æ
    donutChartInstance = new Chart(dtx, {
        type: 'doughnut',
        data: {
            labels: ['‡§â‡§§‡•ç‡§§‡§Æ ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä', '‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä', '‡§ï‡§Æ‡•Ä ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä'],
            datasets: [{
                data: [topQ, midQ, botQ],
                backgroundColor: ['#22c55e', '#fde047', '#ef4444'], // ‡§∞‡§Ç‡§ó
                hoverOffset: 4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '60%', // ‡§°‡•ã‡§®‡§ü ‡§ö‡§æ‡§∞‡•ç‡§ü‡§ö‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§≤‡§π‡§æ‡§® ‡§ï‡•á‡§≤‡§æ
            plugins: {
                legend: { position: 'bottom', labels: { font: { size: 12 } } }, // ‡§≤‡•á‡§ú‡•á‡§Ç‡§° ‡§ñ‡§æ‡§≤‡•Ä
                datalabels: {
                    formatter: (value, ctx) => {
                        let sum = ctx.dataset.data.reduce((a, b) => a + b, 0);
                        let percentage = (value * 100 / sum).toFixed(0) + "%"; // ‡§ü‡§ï‡•ç‡§ï‡•á‡§µ‡§æ‡§∞‡•Ä ‡§¶‡§æ‡§ñ‡§µ‡§æ
                        return percentage;
                    },
                    color: '#fff', // ‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞
                    font: { weight: 'bold', size: 10 } // ‡§´‡•â‡§®‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§≤‡§π‡§æ‡§® ‡§ï‡•á‡§≤‡§æ
                }
            }
        }
    });
}

// ‡§ï‡•ç‡§∑‡•à‡§§‡§ø‡§ú ‡§¨‡§æ‡§∞ ‡§ö‡§æ‡§∞‡•ç‡§ü: ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§π‡§æ‡§Ø ‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞
function renderHorizontalChart(currentData, currentSchemes) {
    const params = currentSchemes; // ‡§π‡•á ‡§Ü‡§§‡§æ ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§®‡•Å‡§∏‡§æ‡§∞ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á‡§≤‡•á‡§≤‡•á ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏ ‡§Ö‡§∏‡§§‡•Ä‡§≤
    if (currentData.length === 0 || params.length === 0) {
        if (horizontalBarChartInstance) { horizontalBarChartInstance.destroy(); horizontalBarChartInstance = null; }
        document.getElementById('horizontalBarChart').innerHTML = `<p class="text-center text-gray-500 mt-4">‡§ö‡§æ‡§∞‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä.</p>`;
        return;
    }

    let talukaScores = currentData.map(r => ({
        taluka: r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'],
        score: params.reduce((a, p) => a + safeNum(r[p]), 0)
    }));

    talukaScores.sort((a, b) => a.score - b.score);

    const talNames = talukaScores.map(item => item.taluka);
    const totals = talukaScores.map(item => item.score);

    // ‡§∞‡§Å‡§ï‡§®‡•Å‡§∏‡§æ‡§∞ ‡§™‡§æ‡§∞‡•ç‡§∂‡•ç‡§µ‡§≠‡•Ç‡§Æ‡•Ä ‡§∞‡§Ç‡§ó ‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ
    const backgroundColors = totals.map((score, index) => {
        if (index < 3) return '#22c55e';
        if (index >= totals.length - 3) return '#ef4444';
        return '#fde047';
    });

    let ctx = document.getElementById('horizontalBarChart').getContext('2d');
    if (horizontalBarChartInstance) horizontalBarChartInstance.destroy(); // ‡§ú‡•Å‡§®‡§æ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§æ‡§§ ‡§Ö‡§∏‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§®‡§∑‡•ç‡§ü ‡§ï‡§∞‡§æ
    horizontalBarChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: talNames,
            datasets: [{
                label: '‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞ (‡§ï‡§Æ‡•Ä = ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á)',
                data: totals,
                backgroundColor: backgroundColors,
                borderColor: backgroundColors.map(color => {
                    // ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•ç‡§Ø‡§æ ‡§ï‡•â‡§®‡•ç‡§ü‡•ç‡§∞‡§æ‡§∏‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§ï‡§ø‡§®‡§æ‡§∞ ‡§∞‡§Ç‡§ó ‡§•‡•ã‡§°‡§æ ‡§ó‡§°‡§¶ ‡§ï‡§∞‡§æ
                    if (color.startsWith('#')) {
                        let c = parseInt(color.substring(1), 16);
                        let r = (c >> 16) & 0xFF;
                        let g = (c >> 8) & 0xFF;
                        let b = (c >> 0) & 0xFF;
                        r = Math.max(0, r - 30);
                        g = Math.max(0, g - 30);
                        b = Math.max(0, b - 30);
                        return `#${(g | (b << 8) | (r << 16)).toString(16).padStart(6, '0')}`;
                    }
                    return color;
                }),
                borderWidth: 1,
                borderRadius: 5,
                hoverBackgroundColor: backgroundColors.map(color => {
                    // ‡§π‡•ã‡§µ‡•ç‡§π‡§∞ ‡§∞‡§Ç‡§ó‡§æ‡§≤‡§æ ‡§•‡•ã‡§°‡§æ ‡§π‡§≤‡§ï‡§æ ‡§ï‡§∞‡§æ
                    if (color.startsWith('#')) {
                        let c = parseInt(color.substring(1), 16);
                        let r = (c >> 16) & 0xFF;
                        let g = (c >> 8) & 0xFF;
                        let b = (c >> 0) & 0xFF;
                        r = Math.min(255, r + 20);
                        g = Math.min(255, g + 20);
                        b = Math.min(255, b + 20);
                        return `#${(g | (b << 8) | (r << 16)).toString(16).padStart(6, '0')}`;
                    }
                    return color;
                })
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            scales: {
                x: {
                    beginAtZero: true,
                    title: { display: true, text: '‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞', font: { size: 14, weight: 'bold' } },
                    grid: { color: 'rgba(0,0,0,0.05)' }
                },
                y: {
                    // ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§≤‡•á‡§¨‡§≤‡§∏‡§æ‡§†‡•Ä ‡§´‡•â‡§®‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡§Æ‡§æ‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡§æ
                    ticks: {
                        font: {
                            size: 10 // ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§≤‡•á‡§¨‡§≤‡§ö‡§æ ‡§´‡•â‡§®‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞
                        }
                    },
                    title: { display: true, text: '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ', font: { size: 14, weight: 'bold' } },
                    grid: { display: false }
                }
            },
            plugins: {
                legend: { display: false },
                title: { display: true, text: '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§è‡§ï‡•Ç‡§£ ‡§∏‡•ç‡§ï‡•ã‡§Ö‡§∞ (‡§ï‡§Æ‡•Ä ‡§ó‡•Å‡§£ = ‡§â‡§§‡•ç‡§§‡§Æ ‡§ï‡§æ‡§Æ‡§ó‡§ø‡§∞‡•Ä)', font: { size: 16, weight: 'bold' } },
                datalabels: {
                    anchor: 'end',
                    align: 'right',
                    formatter: (value) => value.toFixed(0),
                    font: { weight: 'bold', size: 12 }
                }
            }
        }
    });
}

// ‡§™‡•Ö‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞-‡§®‡§ø‡§π‡§æ‡§Ø ‡§ü‡•â‡§™ (‡§ü‡§æ‡§Ø) ‡§§‡§æ‡§≤‡•Å‡§ï‡•á ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
function renderParamTops(currentData, currentSchemes) {
    const params = currentSchemes;
    if (currentData.length === 0 || params.length === 0) {
        document.getElementById('paramTopTable').innerHTML = `<thead><tr><th>‡§Ø‡•ã‡§ú‡§®‡§æ</th><th>üëë Top</th><th>‚öñÔ∏è Middle</th><th>ü•â Down</th></tr></thead><tbody><tr><td colspan="4" class="text-center text-gray-500">‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä</td></tr></tbody>`;
        return;
    }

    let rows = params.map(p => {
        let paramValues = currentData.map(r => safeNum(r[p])).filter(x => x !== Infinity);
        if (paramValues.length === 0) {
            return `<tr><td>${p}</td><td colspan="3" class="text-gray-500">‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä</td></tr>`;
        }

        let min = Math.min(...paramValues);
        let tops = currentData.filter(r => safeNum(r[p]) === min).map(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ']);

        let sortedValues = paramValues.slice().sort((x, y) => x - y);
        let midIndex = Math.floor(sortedValues.length / 2);
        let midVal = sortedValues[midIndex];
        let mids = currentData.filter(r => safeNum(r[p]) === midVal).map(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ']);

        let max = Math.max(...paramValues);
        let downs = currentData.filter(r => safeNum(r[p]) === max).map(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ']);

        return `<tr>
            <td>${p}</td>
            <td style="color:#16a34a;font-weight:700">${tops.join(", ")}</td>
            <td style="color:#ca8a04;font-weight:700">${mids.join(", ")}</td>
            <td style="color:#dc2626;font-weight:700">${downs.join(", ")}</td>
        </tr>`;
    }).join('');
    document.getElementById('paramTopTable').innerHTML =
        `<thead><tr><th>‡§Ø‡•ã‡§ú‡§®‡§æ</th><th>üëë Top</th><th>‚öñÔ∏è Middle</th><th>ü•â Down</th></tr></thead>
        <tbody>${rows}</tbody>`;
}

// ‡§∏‡§Ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§§‡§æ‡§≤‡•Å‡§ï‡•ç‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§Å‡§ï‡§ø‡§Ç‡§ó ‡§Ø‡§æ‡§¶‡•Ä ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
function renderFullTable(currentData, selectedTaluka, selectedScheme) {
    let tbl = document.getElementById('fullTable');
    
    // '‡§Ö.‡§ï‡•ç‡§∞.' ‡§Ü‡§£‡§ø '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' ‡§π‡•á‡§°‡§∞ ‡§®‡•á‡§π‡§Æ‡•Ä ‡§¶‡§æ‡§ñ‡§µ‡§æ
    let displayHeaders = ['‡§Ö.‡§ï‡•ç‡§∞.', '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'];
    let dataHeaders = headers.filter(h => h !== '‡§Ö.‡§ï‡•ç‡§∞.' && h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ');

    // ‡§ú‡§∞ ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§≤‡•Ä ‡§Ö‡§∏‡•á‡§≤, ‡§§‡§∞ ‡§§‡•Ä ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§°‡•á‡§ü‡§æ ‡§π‡•á‡§°‡§∞‡•ç‡§∏‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ú‡•ã‡§°‡§æ
    if (selectedScheme) {
        displayHeaders.push(selectedScheme);
        dataHeaders = [selectedScheme]; // ‡§´‡§ï‡•ç‡§§ ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•Ä ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§°‡•á‡§ü‡§æ‡§∏‡§æ‡§†‡•Ä
    } else {
        displayHeaders = headers; // ‡§∏‡§∞‡•ç‡§µ ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§¶‡§æ‡§ñ‡§µ‡§æ
    }

    let th = displayHeaders.map((h, idx) => {
        let classes = '';
        if (idx === 0) classes = 'sticky-col-0'; // For '‡§Ö.‡§ï‡•ç‡§∞.'
        if (idx === 1) classes = 'sticky-col-1'; // For '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'
        return `<th class="${classes}">${h}</th>`;
    }).join('');

    let tr = currentData.map((r, index) => {
        let rowContent = `<td class="sticky-col-0">${index + 1}</td><td class="sticky-col-1">${r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ']}</td>`;
        
        // ‡§ú‡§∞ ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§≤‡•Ä ‡§Ö‡§∏‡•á‡§≤, ‡§§‡§∞ ‡§´‡§ï‡•ç‡§§ ‡§§‡•ç‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡§ö‡•á ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§¶‡§æ‡§ñ‡§µ‡§æ
        if (selectedScheme) {
            rowContent += `<td>${r[selectedScheme] === "" ? '-' : r[selectedScheme]}</td>`;
        } else {
            // ‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ, ‡§∏‡§∞‡•ç‡§µ ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•ç‡§∏‡§ö‡•Ä ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡•á ‡§¶‡§æ‡§ñ‡§µ‡§æ
            rowContent += headers.filter(h => h !== '‡§Ö.‡§ï‡•ç‡§∞.' && h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ').map(h => {
                const val = r[h];
                return `<td>${val === "" ? '-' : val}</td>`;
            }).join('');
        }
        return `<tr>${rowContent}</tr>`;
    }).join('');
    tbl.innerHTML = `<thead><tr>${th}</tr></thead><tbody>${tr}</tbody>`;

    // ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡§æ ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§π‡§æ‡§Ø‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡§æ
    if (selectedTaluka) {
        highlightTableRow(selectedTaluka);
    }
}

// ‡§§‡•Å‡§≤‡§®‡§æ ‡§°‡•ç‡§∞‡•â‡§™‡§°‡§æ‡§â‡§® ‡§™‡•â‡§™‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü ‡§ï‡§∞‡§æ
function populateCmpDropdowns() {
    ['cmpA', 'cmpB'].forEach(id => {
        document.getElementById(id).innerHTML =
            `<option value="" selected disabled>‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</option>` + talukas.map(t => `<option>${t}</option>`).join('');
    });
}

// ‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§π‡§Å‡§°‡§≤‡§∞
document.getElementById('talukaSelect').onchange = function() {
    filterDataAndRender();
};

// ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§π‡§Å‡§°‡§≤‡§∞
document.getElementById('schemeSelect').onchange = function() {
    filterDataAndRender();
};

// ‡§π‡•â‡§∞‡§ø‡§ù‡•â‡§®‡•ç‡§ü‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§®‡§ø‡§µ‡§°‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§π‡§Å‡§°‡§≤‡§∞
document.getElementById('schemeSelectForHorizontalChart').onchange = function() {
    filterDataAndRender();
};

// ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§¨‡§ü‡§£ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ù‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§π‡§Å‡§°‡§≤‡§∞
document.getElementById('resetBtn').onclick = function() {
    document.getElementById('talukaSelect').value = ""; // ‡§°‡•ç‡§∞‡•â‡§™‡§°‡§æ‡§â‡§® ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ
    document.getElementById('schemeSelect').value = ""; // ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§°‡•ç‡§∞‡•â‡§™down ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ
    document.getElementById('schemeSelectForHorizontalChart').value = ""; // ‡§π‡•â‡§∞‡§ø‡§ù‡•â‡§®‡•ç‡§ü‡§≤ ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§∏‡•ç‡§ï‡•Ä‡§Æ ‡§°‡•ç‡§∞‡•â‡§™‡§°‡§æ‡§â‡§® ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§æ
    filterDataAndRender(); // ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•Ç‡§® ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§æ
    document.getElementById('resetBtn').style.display = 'none'; // ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§¨‡§ü‡§£ ‡§≤‡§™‡§µ‡§æ
    document.querySelectorAll('#fullTable tbody tr').forEach(row => row.classList.remove('selected')); // ‡§π‡§æ‡§Ø‡§≤‡§æ‡§á‡§ü ‡§ï‡§æ‡§¢‡§æ
};

// ‡§ü‡•á‡§¨‡§≤ ‡§™‡§Ç‡§ï‡•ç‡§§‡•Ä ‡§π‡§æ‡§Ø‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡§æ
function highlightTableRow(taluka) {
    document.querySelectorAll('#fullTable tbody tr').forEach(row => {
        if (row.firstElementChild && row.firstElementChild.nextElementSibling && row.firstElementChild.nextElementSibling.textContent === taluka)
            row.classList.add('selected');
        else row.classList.remove('selected');
    });
}

// ‡§§‡•Å‡§≤‡§®‡§æ ‡§¨‡§ü‡§£ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ù‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§á‡§µ‡•ç‡§π‡•á‡§Ç‡§ü ‡§π‡§Å‡§°‡§≤‡§∞
document.getElementById('cmpBtn').onclick = function() {
    let a = document.getElementById('cmpA').value;
    let b = document.getElementById('cmpB').value;

    if (!talukas.includes(a) || !talukas.includes(b) || a === b) {
        document.getElementById('cmpResult').innerHTML = "<div class='text-red-700 font-semibold text-center mt-4'>‡§ï‡•É‡§™‡§Ø‡§æ ‡§§‡•Å‡§≤‡§®‡§æ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§¶‡•ã‡§® ‡§µ‡•á‡§ó‡§≥‡•á ‡§§‡§æ‡§≤‡•Å‡§ï‡•á ‡§®‡§ø‡§µ‡§°‡§æ.</div>";
        return;
    }

    let pa = data.find(r => r['‡§§‡§æ‡§≤‡•Å‡§ï‡§æ'] === a);
    let pb = data.find(r => r['‡§§‡§æ‡§≤uka'] === b); 

    const params = headers.filter(h => h !== '‡§§‡§æ‡§≤‡•Å‡§ï‡§æ' && h !== '‡§Ö.‡§ï‡•ç‡§∞.');

    let rows = params.map(p => {
        let av = safeNum(pa[p]);
        let bv = safeNum(pb[p]);
        let diff = av - bv;
        let sig = diff === 0 ? '-' : diff < 0 ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è'; // ‚¨ÜÔ∏è ‡§Æ‡•ç‡§π‡§£‡§ú‡•á A ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á, ‚¨áÔ∏è ‡§Æ‡•ç‡§π‡§£‡§ú‡•á B ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á

        let colorA = '';
        let colorB = '';
        if (av < bv) { colorA = '#16a34a'; colorB = '#ef4444'; } // A ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á (‡§ï‡§Æ‡•Ä ‡§∞‡§Å‡§ï)
        else if (bv < av) { colorA = '#ef4444'; colorB = '#16a34a'; } // B ‡§ö‡§æ‡§Ç‡§ó‡§≤‡•á

        return `<tr>
            <td>${p}</td>
            <td style="color:${colorA};font-weight:700">${av !== Infinity ? av : '-'}</td>
            <td style="color:${colorB};font-weight:700">${bv !== Infinity ? bv : '-'}</td>
            <td>${sig} ${Math.abs(diff)}</td>
        </tr>`;
    }).join('');

    document.getElementById('cmpResult').innerHTML =
        `<table class="min-w-full border mt-4"><thead><tr><th>‡§Ø‡•ã‡§ú‡§®‡§æ</th><th>${a}</th><th>${b}</th><th>‡§´‡§∞‡§ï</th></tr></thead><tbody>${rows}</tbody></table>`;
};

// ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§≤‡•ã‡§° ‡§ù‡§æ‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ init ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§æ
window.onload = init;
</script>
</body>
</html>
